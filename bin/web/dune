(executable
  (name index)
  (modes byte js)
  (modules index draw)
  (preprocess (pps js_of_ocaml-ppx ppx_deriving.show) )
  (libraries eincalc js_of_ocaml js_of_ocaml-lwt js_of_ocaml-lwt.graphics)
  (js_of_ocaml 
    ; todo: maybe disable errors and exception. add effects support when needed ?
    ;(flags :standard --opt 3 --source-map --disable staticeval --disable share --target-env browser --enable=with-js-error --enable=excwrap)
    (flags :standard  --target-env browser)
    (build_runtime_flags (:standard --target-env browser))))

;(dirs :standard \ node_modules static src)
; generated inside the src/lib 
;(rule
 ;(mode promote)
 ;(targets index.js)
 ;(deps index.bc.js)
 ;(action (copy index.bc.js index.js)))
